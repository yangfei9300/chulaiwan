(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/circle/circle"],{"2e77":function(t,e,o){"use strict";var n=o("7e13"),i=o.n(n);i.a},"6fc2":function(t,e,o){"use strict";(function(t,e){var n=o("4ea4");o("a1a6");n(o("66fd"));var i=n(o("e46e"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},"7e13":function(t,e,o){},"80ce":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var n={videos:function(){return o.e("components/videos/videos").then(o.bind(null,"af9a"))},loadApp:function(){return o.e("components/loadApp/loadApp").then(o.bind(null,"8d77"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.FriendList.length),n=t.__map(t.FriendList,(function(e,n){var i=t.__get_orig(e),a=o>0?t.Friendfollow.includes(e.id):null;return{$orig:i,g1:a}})),i=t.TabTrue?t.__map(t.MomentList,(function(e,o){var n=t.__get_orig(e),i=2!=e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=1==e.photo.length&&o.width>o.height&&o.width>250;return{$orig:i,g2:a}})):null,a=2!=e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=1==e.photo.length&&o.width<o.height&&o.height>300;return{$orig:i,g3:a}})):null,s=2!=e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=1==e.photo.length&&o.width==o.height;return{$orig:i,g4:a}})):null,c=2!=e.type?e.photo.length:null,u=2!=e.type&&4!=c?e.photo.length:null;return{$orig:n,l1:i,l2:a,l3:s,g5:c,g6:u}})):null,a=t.TabTrue?null:t.__map(t.MomentListtow,(function(e,o){var n=t.__get_orig(e),i=1==e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=e.photo.length;return{$orig:i,g7:a}})):null,a=1==e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=e.photo.length>1&&e.photo.length<4;return{$orig:i,g8:a}})):null,s=1==e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=1==e.photo.length&&o.width>o.height&&o.width>250;return{$orig:i,g9:a}})):null,c=1==e.type?t.__map(e.photo,(function(o,n){var i=t.__get_orig(o),a=1==e.photo.length&&o.width<o.height&&o.height>300;return{$orig:i,g10:a}})):null,u=1==e.type?e.photo.length:null;return{$orig:n,l5:i,l6:a,l7:s,l8:c,g11:u}}));t.$mp.data=Object.assign({},{$root:{g0:o,l0:n,l4:i,l9:a}})},a=[]},bbb1:function(t,e,o){"use strict";o.r(e);var n=o("efa0"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},e46e:function(t,e,o){"use strict";o.r(e);var n=o("80ce"),i=o("bbb1");for(var a in i)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("2e77");var s=o("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"7e5b9f4e",null,!1,n["a"],void 0);e["default"]=c.exports},efa0:function(t,e,o){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{jiaonang:{},isFriendsShow:!0,FriendList:[],MassageList:{},MomentList:[],MomentListtow:[],Friendfollow:[],TabTrue:!0,page:1,page1:1,baseurl:getApp().globalData.baseurl,token:getApp().globalData.token,uid:getApp().globalData.uuid,tabbarlist:[{id:0,img:"../../static/TabImg/tabbar11.png",name:"首页"},{id:1,img:"../../static/TabImg/tabbar22.png",name:"活动"},{id:2,img:"../../static/TabImg/fabu.png",name:"发布"},{id:3,img:"../../static/TabImg/quanzi.png",name:"圈子"},{id:4,img:"../../static/TabImg/tabbar3.png",name:"我的"}],showApp:!1}},onLoad:function(){var e=t.getStorageSync("token");e&&(this.token=e);e=t.getStorageSync("token");e&&(this.tokenValue=t.getStorageSync("token")),t.hideTabBar({animation:!1})},onPageScroll:function(t){console.log("页面华东",t),0==t.scrollTop?this.isFriendsShow=!0:t.scrollTop>200&&(this.isFriendsShow=!1)},mounted:function(){console.error("mountedmounted"),this.token&&(this.getFriend(),this.getMassage(),this.getmomentTow()),this.getmoment()},onPullDownRefresh:function(){this.isFriendsShow=!0,this.page=1,this.page1=1,this.MomentList=[],this.MomentListtow=[],this.token&&(this.getFriend(),this.getMassage(),this.getmomentTow()),this.getmoment(),setTimeout((function(e){t.stopPullDownRefresh()}),1e3)},onReachBottom:function(){this.isFriendsShow=!1,this.getmoment(),this.token&&this.getmomentTow()},onShow:function(){var e=t.getStorageSync("token");e&&(this.tokenValue=t.getStorageSync("token"),this.token=t.getStorageSync("token")),console.error("onShowonShow"),this.getIsToken()},methods:{getIsToken:function(){var e=this,o=t.getStorageSync("token");t.request({url:this.baseurl+"/api/IosVisitor/checkToken",method:"POST",data:{token:o,city:t.getStorageSync("citySel")},header:{xcx:1,token:o},success:function(o){var n=o.data;0==n.code&&(getApp().globalData.token=null,e.token=null,t.removeStorageSync("token")),e.onshowPage()},fail:function(){},complete:function(){}})},onshowPage:function(){this.getMassage(),this.getJiaonang()},hideview:function(){},showLoadApp:function(){this.showApp=!this.showApp},getJiaonang:function(){var t=o.getMenuButtonBoundingClientRect();this.jiaonang=t},showApp:function(){t.showToast({title:"完整功能请下载APP",icon:"none"})},delDongtai:function(e,o){var n=this;t.showModal({title:"提示",content:"确定要删除动态吗",success:function(t){t.confirm?n.delDongtaiDa(e,o):t.cancel&&console.log("用户点击取消")}})},delDongtaiDa:function(e,o){var n=this;t.request({url:this.baseurl+"/api/moments/momentsDel",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:e.moments_no,city:t.getStorageSync("citySel")},success:function(i){console.log(i),1==i.data.code?(t.showToast({title:"删除成功",icon:"none"}),n.delDataDongtai(e,o)):t.showToast({title:i.data.msg,icon:"none"})},fail:function(){},complete:function(){}})},delDataDongtai:function(t,e){var o=this.TabTrue,n=[];n=o?this.MomentList:this.MomentListtow;for(var i=[],a=0;a<n.length;a++)e!=a&&i.push(n[a]);o?this.MomentList=i:this.MomentListtow=i,this.$forceUpdate()},Tab_zuixin:function(){this.TabTrue=!0},Tab_guanzhu:function(){this.token?this.TabTrue=!1:(t.showToast({title:"请先登录",icon:"none"}),setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3))},getFriend:function(){var e=this;t.request({url:this.baseurl+"/api/moments/friend",method:"POST",header:{xcx:1,token:this.token},data:{city:t.getStorageSync("citySel")},success:function(t){e.FriendList=t.data.data},fail:function(){},complete:function(){}})},getMassage:function(){var e=this;this.token&&t.request({url:this.baseurl+"/api/userMessage/getUserMessageUnRead",method:"POST",header:{xcx:1,token:this.token},data:{city:t.getStorageSync("citySel")},success:function(o){1001==o.data.code?(t.showToast({title:"请先登录",icon:"none"}),setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3)):1==o.data.code&&(e.MassageList=o.data.data.maessage1)},fail:function(){},complete:function(){}})},getmoment:function(){var e=this,o="/api/moments/momentsList";this.tokenValue||(o="/api/IosVisitor/momentsList"),t.request({url:this.baseurl+o,method:"POST",header:{xcx:1,token:this.token},data:{page:this.page++,num:3,type:1,video:1,city:t.getStorageSync("citySel")},success:function(t){console.log("圈子列表",t);for(var o=t.data.data,n=0;n<o.length;n++)o[n].photo=o[n].photo.map((function(t){return JSON.parse(t)}));for(var i=0;i<o.length;i++)o[i].video_xcx.length>0&&(o[i].video_xcx[0].width<o[i].video_xcx[0].height?(o[i].video_xcx[0].width_b=300,o[i].video_xcx[0].height_b=300/o[i].video_xcx[0].width*o[i].video_xcx[0].height):(o[i].video_xcx[0].width_b=600,o[i].video_xcx[0].height_b=600/o[i].video_xcx[0].width*o[i].video_xcx[0].height));e.MomentList=e.MomentList.concat(o),console.log("更新之后圈子列表",e.MomentList)},fail:function(){},complete:function(){}})},getmomentTow:function(){var e=this,o="/api/moments/momentsList";this.tokenValue||(o="/api/IosVisitor/momentsList"),t.request({url:this.baseurl+o,method:"POST",header:{xcx:1,token:this.token},data:{page:this.page1++,num:3,type:2,city:t.getStorageSync("citySel")},success:function(t){for(var o=t.data.data,n=0;n<o.length;n++)o[n].photo=o[n].photo.map((function(t){return JSON.parse(t)}));e.MomentListtow=e.MomentListtow.concat(o)},fail:function(){},complete:function(){}})},previewImage:function(e,o,n){console.log(e,o,n);var i=[];e.forEach((function(t){return i.push(t.imgUrl)})),console.log(i),t.previewImage({current:n,urls:i,success:function(t){console.log(t)}})},FriendFollow:function(e){var o=this,n=t.getStorageSync("token");if(!n)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var i=t.getStorageSync("loginInfo");if(i&&0==i.status)return t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1;t.request({url:this.baseurl+"/api/user/follow",method:"POST",header:{xcx:1,token:this.token},data:{uuid:e,city:t.getStorageSync("citySel")},success:function(t){1==t.data.data&&o.Friendfollow.push(e)},fail:function(){},complete:function(){}})},follow:function(e,o){var n=this,i=t.getStorageSync("token");if(!i)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var a=t.getStorageSync("loginInfo");if(a&&0==a.status)return t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1;t.request({url:this.baseurl+"/api/user/follow",method:"POST",header:{xcx:1,token:this.token},data:{uuid:e,city:t.getStorageSync("citySel")},success:function(t){if(console.log("关注",t),1==t.data.data){console.log("关注成功"),n.MomentList[o].is_follow=1,console.log(n.MomentList);n.MomentList.filter((function(t,o){console.log(t.uuid==e,o),t.uuid==e&&(n.MomentList[o].is_follow=1)}))}else console.log("取消关注成功"),n.MomentList.filter((function(t,o){console.log(t.uuid==e,o),t.uuid==e&&(n.MomentList[o].is_follow=0)}))},fail:function(){},complete:function(){}})},MomentLike:function(e,o,n){var i=this,a=t.getStorageSync("token");if(!a)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var s=t.getStorageSync("loginInfo");if(s&&0==s.status)return t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1;1==n?t.request({url:this.baseurl+"/api/moments/momentsLike",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:e,city:t.getStorageSync("citySel")},success:function(t){console.log("喜欢",t.data.data),1==t.data.data?(i.MomentList[o].is_like=1,i.MomentList[o].like_num+=1):0==t.data.data&&(i.MomentList[o].is_like=0,i.MomentList[o].like_num-=1)},fail:function(){},complete:function(){}}):2==n&&t.request({url:this.baseurl+"/api/moments/momentsLike",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:e,city:t.getStorageSync("citySel")},success:function(t){console.log("喜欢",t.data.data),1==t.data.data?(i.MomentListtow[o].is_like=1,i.MomentListtow[o].like_num+=1):0==t.data.data&&(i.MomentListtow[o].is_like=0,i.MomentListtow[o].like_num-=1)},fail:function(){},complete:function(){}})},navDetail:function(e){t.navigateTo({url:"../../pages_quanzi/criclleDetal/criclleDetal?moments_no=".concat(e),success:function(t){},fail:function(){},complete:function(){}}),console.log(11)},release:function(){t.navigateTo({url:"../../pages_quanzi/release/release",success:function(t){},fail:function(){},complete:function(){}})},navswich:function(e){0==e?t.switchTab({url:"../index/index"}):1==e?t.switchTab({url:"../activity/activity"}):2==e?t.navigateTo({url:"../Group/Group",success:function(t){},fail:function(){},complete:function(){}}):3==e?t.switchTab({url:"../circle/circle"}):4==e&&t.switchTab({url:"../my/my"})},navzhongxin:function(e){t.navigateTo({url:"/pages_wode/PersonalCenter/PersonalCenter?uuid="+e,success:function(t){},fail:function(){},complete:function(){}})},notification:function(){t.navigateTo({url:"/pages_wode/notification/notification",success:function(t){},fail:function(){},complete:function(){}})}}};e.default=n}).call(this,o("543d")["default"],o("bc2e")["default"])}},[["6fc2","common/runtime","common/vendor"]]]);