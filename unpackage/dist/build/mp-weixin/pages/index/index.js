(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"05f9":function(t,e,i){"use strict";i.r(e);var n=i("d834"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},"26f4":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uniRate:function(){return i.e("uni_modules/uni-rate/components/uni-rate/uni-rate").then(i.bind(null,"4535"))},loadApp:function(){return i.e("components/loadApp/loadApp").then(i.bind(null,"8d77"))}},a=function(){var t=this,e=t.$createElement,i=(t._self._c,t.list111.length),n=t.__map(t.shangjialist,(function(e,i){var n=t.__get_orig(e),a=e.distance.toFixed(2);return{$orig:n,g1:a}})),a=t.wqActivityList.length;t.$mp.data=Object.assign({},{$root:{g0:i,l0:n,g2:a}})},o=[]},"4bfc":function(t,e,i){"use strict";var n=i("bf50"),a=i.n(n);a.a},"4e81":function(t,e,i){"use strict";i.r(e);var n=i("26f4"),a=i("05f9");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("4bfc");var s=i("f0c5"),c=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"d2993fd4",null,!1,n["a"],void 0);e["default"]=c.exports},"80d6":function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("a1a6");n(i("66fd"));var a=n(i("4e81"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},bf50:function(t,e,i){},d834:function(t,e,i){"use strict";(function(t,n){var a=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;a(i("d32e"));var o={};t.onNeedPrivacyAuthorization((function(t){console.log("触发：onNeedPrivacyAuthorization",t),"function"===typeof o&&o(t)}));var s={data:function(){return{showuquanAlert:!1,moveX:2,shangjialist:[],baseurl:getApp().globalData.baseurl,token:getApp().globalData.token,map:null,list1:[],lat:getApp().globalData.lat,lng:getApp().globalData.lng,count:5,value:2,current:0,current1:0,slideCustomStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"36rpx"},options:{effect:"cards",cardsEffect:{rotate:!1,perSlideOffset:18,perSlideRotate:2},slidesPerView:1,initialSlide:2,loop:!1},paihanglist:["https://cdn.zebraui.com/zebra-ui/images/swipe-demo/swipe1.jpg","https://cdn.zebraui.com/zebra-ui/images/swipe-demo/swipe2.jpg","https://cdn.zebraui.com/zebra-ui/images/swipe-demo/swipe3.jpg","https://cdn.zebraui.com/zebra-ui/images/swipe-demo/swipe4.jpg","https://cdn.zebraui.com/zebra-ui/images/swipe-demo/swipe5.jpg"],Catelist:[],list111:[],list222:[],value6:0,tabbarlist:[{id:0,img:"../../static/TabImg/tabbar1.png",name:"首页"},{id:1,img:"../../static/TabImg/tabbar22.png",name:"活动"},{id:2,img:"../../static/TabImg/fabu.png",name:"发布"},{id:3,img:"../../static/TabImg/quanzi1.png",name:"圈子"},{id:4,img:"../../static/TabImg/tabbar3.png",name:"我的"}],tokenValue:null,wxcode:"",showApp:!1,osName:"",wqActivityList:[],fenzhanList:[],citySel:"济南市"}},onLoad:function(){var t=this,e=n.getStorageSync("citySel");e&&(this.citySel=e),n.getSystemInfo({success:function(e){t.osName=e.osName},complete:function(t){console.log("新下",t)}}),n.login({complete:function(e){console.log("登录code",e),t.wxcode=e.code}}),n.hideTabBar({animation:!1}),this.getYejian()},onShow:function(){this.getIsToken()},mounted:function(){this.slider(this.token),this.actCate(this.token),this.act(),this.business(),this.paihang(),this.getFenzhan()},onShareAppMessage:function(t){return{title:"出来玩就现在",path:"/pages/index/index",imageUrl:"https://jiayiwangluo.oss-cn-beijing.aliyuncs.com/shop_comment/20240708171949.png"}},onShareTimeline:function(){return{title:"出来玩就现在",path:"/pages/index/index",imageUrl:"https://jiayiwangluo.oss-cn-beijing.aliyuncs.com/shop_comment/20240708171949.png"}},methods:{cityChange:function(t){console.log("===cityChange",t);var e=this.fenzhanList[parseInt(t.detail.value)].nickname;this.citySel=e,n.setStorageSync("citySel",e),this.slider(this.token),this.actCate(this.token),this.act(),this.business(),this.paihang()},getFenzhan:function(){var t=this;n.request({url:this.baseurl+"/api/area/getCitySite",method:"POST",data:{token:this.token,num:3,city:n.getStorageSync("citySel")},header:{xcx:1,token:this.token},success:function(e){console.log("只管女里",e),t.fenzhanList=e.data.data},fail:function(){},complete:function(){}})},toInfo:function(t){n.navigateTo({url:"/pages1/wqActivity/wqActivity?id="+t.id})},toWqs:function(){n.navigateTo({url:"/pages1/activityWQList/activityWQList"})},getWqActivity:function(){var t=this,e="/api/act/pastActList";this.tokenValue||(e="/api/IosVisitor/pastActList"),n.request({url:this.baseurl+e,method:"POST",data:{token:this.token,num:3,city:n.getStorageSync("citySel")},header:{xcx:1,token:this.token},success:function(e){var i=e.data;1==i.code&&(console.log("往期活动",e),t.wqActivityList=e.data.data)},fail:function(){},complete:function(){}})},alertGps:function(){var e=this;t.getSetting({success:function(t){console.log("当前设置",t.authSetting),console.log("当前设置",JSON.stringify(t));var i=JSON.stringify(t);i.indexOf('"scope.userFuzzyLocation":true')>=0?(console.log("直接获取位置"),e.getWeizhi()):(console.log("需要授权获取位置"),n.showModal({title:"授权",content:"需要获取您的位置信息，",success:function(t){t.confirm?e.getWeizhi():t.cancel&&console.log("用户点击取消")}}))}})},getWeizhi:function(){var t=this;n.getFuzzyLocation({type:"wgs84",success:function(e){var i=e.latitude,a=e.longitude;console.log("微信鼎和",e),n.setStorageSync("lat",i),n.setStorageSync("lng",a),getApp().globalData.lat=i,getApp().globalData.lng=a,t.lat=i,t.lng=a,t.actCate(t.token),t.act(),t.business()},fail:function(t){n.showToast({title:"定位失败",icon:"none"})},complete:function(t){console.log("结果",t)}})},getIsToken:function(){var t=this,e=n.getStorageSync("token");n.request({url:this.baseurl+"/api/IosVisitor/checkToken",method:"POST",data:{token:e,city:n.getStorageSync("citySel")},header:{xcx:1,token:e},success:function(e){var i=e.data;0==i.code&&(getApp().globalData.token=null,t.token=null,n.removeStorageSync("token")),0==i.data.is_reg&&n.setStorageSync("loginInfo",{status:0}),t.onshowPage()},fail:function(){},complete:function(){}})},onshowPage:function(){var e=this,i=n.getStorageSync("token");i&&(this.tokenValue=n.getStorageSync("token")),this.act(),this.getWqActivity(),t.getPrivacySetting({success:function(t){if(console.log("是否需要授权：",t.needAuthorization,"隐私协议的名称为：",t.privacyContractName),t.needAuthorization)e.showuquanAlert=t.needAuthorization;else{var i=n.getStorageSync("lat");i?e.getWeizhi():e.alertGps()}},fail:function(){},complete:function(){}})},showuquanAlertClick:function(){this.showuquanAlert=!this.showuquanAlert},handleAgree:function(t){console.log("handleAgree",t),this.showuquanAlert=!1;var e=n.getStorageSync("lat");e?this.getWeizhi():this.alertGps()},privacyHandler:function(){var e=this;t.getPrivacySetting?t.getPrivacySetting({success:function(t){console.log("是否需要授权：",t.needAuthorization,"隐私协议的名称为：",t.privacyContractName),t.needAuthorization||e.$emit("agree")},fail:function(){},complete:function(){}}):this.$emit("agree")},toyinsi:function(){t.openPrivacyContract({success:function(){},fail:function(){},complete:function(){}})},authorization:function(t){console.log("authorization",t)},agreeprivacyauthorization:function(e){var i=this;t.getPrivacySetting({success:function(t){console.log(t),t.needAuthorization&&i.setData({showPrivacy:!0})},fail:function(){},complete:function(){}})},hideview:function(){},showLoadApp:function(){this.showApp=!this.showApp},getYejian:function(){t.getSystemInfo({success:function(t){var e="dark"===t.theme;console.log("夜间模式状态:",e)}})},tokenValueBaocun:function(){n.setStorageSync("token",this.tokenValue)},acccccc:function(t){console.log(t.detail.current),this.moveX=t.detail.current},act:function(){var t=this;this.current=0;var e="/api/act/actList";this.tokenValue||(e="/api/IosVisitor/actList"),n.request({url:this.baseurl+e,method:"POST",data:{cate_id:0,page:1,num:20,sort:3,city:n.getStorageSync("citySel")},header:{xcx:1,token:this.token},success:function(e){t.list111=e.data.data;for(var i=0;i<t.list111.length;i++)t.list111[i].p_num_str.split("/")},fail:function(){},complete:function(){}})},paihang:function(){var t=this,e="/api/user/userRank";this.tokenValue||(e="/api/IosVisitor/userRank"),n.request({url:this.baseurl+e,method:"POST",data:{city:n.getStorageSync("citySel")},header:{xcx:1,token:this.token},success:function(e){1001==e.data.code?(n.showToast({title:"请先登录",icon:"none"}),setTimeout((function(t){n.reLaunch({url:"/pages/Login/Login"})}),1e3)):1==e.data.code&&(t.paihanglist=e.data.data)},fail:function(){},complete:function(){}})},business:function(){var t=this,e="/api/shop/shopList";this.tokenValue||(e="/api/IosVisitor/shopList"),n.request({url:this.baseurl+e,method:"POST",header:{xcx:1,token:this.token},data:{page:1,num:3,cate_id:0,sort:3,lat:this.lat,lng:this.lng,money_max:"300",money_min:"0",keywords:"",city:n.getStorageSync("citySel")},success:function(e){t.shangjialist=e.data.data;for(var i=0;i<t.shangjialist.length;i++){var n=t.lat,a=t.lng,o=t.shangjialist[i].lat,s=t.shangjialist[i].lng;t.shangjialist[i].distance=t.space(n,a,o,s)}},fail:function(){},complete:function(){}})},space:function(t,e,i,n){var a=t*Math.PI/180,o=i*Math.PI/180,s=a-o,c=e*Math.PI/180-n*Math.PI/180,u=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(a)*Math.cos(o)*Math.pow(Math.sin(c/2),2)));return u*=6378.137,u=Math.round(1e4*u)/1e4,u},actCate:function(t){var e=this,i="/api/act/actCate";this.tokenValue||(i="/api/IosVisitor/actCate"),n.request({url:this.baseurl+i,method:"POST",header:{xcx:1,token:this.token},data:{page:1,num:6,city:n.getStorageSync("citySel")},success:function(t){e.Catelist=t.data.data},fail:function(){},complete:function(){}})},slider:function(t){var e=this,i="/api/page/homeSlider";this.tokenValue||(i="/api/IosVisitor/homeSlider"),n.request({url:this.baseurl+i,method:"POST",data:{city:n.getStorageSync("citySel")},header:{xcx:1,token:t},success:function(t){e.list1=t.data.data},fail:function(){},complete:function(){}})},herf:function(t,e){var i;"act"==t?i="../../pages_huodong/ActivityDetail/ActivityDetail?act_no=":"shop"==t?i="../../pages_huodong/Detail/Detail?lat=${lats}&lng=${lngs}&shop_no=":"act_show"==t?i="../../pages_wode/PastDetail/PastDetail?id=":"page"==t&&(i="../../pages_huodong/shop/shop?shop_no="),console.log(i),n.navigateTo({url:"".concat(i)+e,success:function(t){},fail:function(){},complete:function(){}})},shangjiatuijian:function(t,e,i){n.navigateTo({url:"../../pages_huodong/Detail/Detail?shop_no=".concat(t,"&lat=").concat(e,"&lng=").concat(i),success:function(t){},fail:function(){},complete:function(){}})},onpicture:function(t,e,i){n.setStorageSync("activityTypeInfo",i),n.navigateTo({url:"../../pages_huodong/SixModules/SixModules?id=".concat(t,"&sort=").concat(e),success:function(t){},fail:function(){},complete:function(){}})},scrollindex:function(t,e,i){var a=this;if(0==i){this.current=e;var o="/api/act/actList";this.tokenValue||(o="/api/IosVisitor/actList"),n.request({url:this.baseurl+o,method:"POST",header:{xcx:1,token:this.token},data:{cate_id:t,page:1,num:3,sort:3,city:n.getStorageSync("citySel")},success:function(t){a.list111=t.data.data},fail:function(){},complete:function(){}})}else if(1==i){this.current1=e;o="/api/shop/shopList";this.tokenValue||(o="/api/IosVisitor/shopList"),n.request({url:this.baseurl+o,method:"POST",header:{xcx:1,token:this.token},data:{page:1,num:3,cate_id:t,sort:3,lat:this.lat,lng:this.lng,money_max:"",money_min:"",keywords:"",city:n.getStorageSync("citySel")},success:function(t){console.log("商家",t),a.shangjialist=t.data.data;for(var e=0;e<a.shangjialist.length;e++){var i=a.lat,n=a.lng,o=a.shangjialist[e].lat,s=a.shangjialist[e].lng;a.shangjialist[e].distance=a.space(i,n,o,s)}},fail:function(){},complete:function(){}})}},activitys:function(t){n.navigateTo({url:"../../pages_huodong/ActivityDetail/ActivityDetail?act_no="+t,success:function(t){},fail:function(){},complete:function(){}})},navmy:function(t){n.navigateTo({url:"/pages_wode/PersonalCenter/PersonalCenter?uuid="+t,success:function(t){},fail:function(){},complete:function(){}})},navswich:function(t){console.log("tabbar跳转",t),0==t?n.switchTab({url:""}):1==t?n.switchTab({url:"../activity/activity"}):2==t?n.navigateTo({url:"../Group/Group",success:function(t){},fail:function(){},complete:function(){}}):3==t?n.switchTab({url:"../circle/circle"}):4==t&&n.switchTab({url:"../my/my"})}}};e.default=s}).call(this,i("bc2e")["default"],i("543d")["default"])}},[["80d6","common/runtime","common/vendor"]]]);