(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_quanzi/criclleDetal/criclleDetal"],{"0b23":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{baseurl:getApp().globalData.baseurl,token:getApp().globalData.token,moments_no:null,page:1,type:0,commentValue:"",id:"",back_id:"",placeholder:"机会来了！马上发言",list:[],CommentList:[],uid:getApp().globalData.uuid,pingjiaClick:!0}},onLoad:function(t){console.log(t),this.moments_no=t.moments_no},mounted:function(){this.getmoments(),this.getComment()},onPullDownRefresh:function(){this.page=1,this.getComments(),this.getmoments()},onReachBottom:function(){this.getComment()},methods:{delLongClick:function(e){var o=this;t.showModal({title:"提示",content:"确认要删除吗",success:function(t){t.confirm?o.delComment(e):t.cancel&&console.log("用户点击取消")}})},delComment:function(e){var o=this,n=t.getStorageSync("token");if(!n)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var i=t.getStorageSync("loginInfo");if(i&&0==i.status)return t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1;t.request({url:this.baseurl+"/api/moments/momentsCommentDel",method:"POST",header:{xcx:1,token:this.token},data:{comment_id:e.id,city:t.getStorageSync("citySel")},success:function(e){console.log("关注",e),1==e.data.code&&(t.showToast({title:"删除成功",icon:"none"}),setTimeout((function(t){o.shauxinComm()}),1e3))},fail:function(){},complete:function(){}})},shauxinComm:function(){this.page=1,this.getComments(),this.getmoments()},follow:function(e){var o=this;t.request({url:this.baseurl+"/api/user/follow",method:"POST",header:{xcx:1,token:this.token},data:{uuid:e,city:t.getStorageSync("citySel")},success:function(e){console.log("关注",e),1==e.data.data&&(t.showToast({title:"关注成功",icon:"none"}),o.list.is_follow=1)},fail:function(){},complete:function(){}})},toUserInfo:function(e){t.navigateTo({url:"/pages_wode/PersonalCenter/PersonalCenter?uuid="+e.uuid})},getComments:function(){var e=this;t.request({url:this.baseurl+"/api/moments/momentsComment",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,page:this.page++,num:20,city:t.getStorageSync("citySel")},success:function(o){console.log("圈子详情回复",o.data.data),e.CommentList=o.data.data,e.id=o.data.data.id,t.stopPullDownRefresh()},fail:function(){},complete:function(){}})},getComment:function(){var e=this;t.request({url:this.baseurl+"/api/moments/momentsComment",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,page:this.page++,num:20,city:t.getStorageSync("citySel")},success:function(t){console.log("圈子详情回复",t.data.data),0==t.data.data.length?e.page-=1:(e.CommentList=e.CommentList.concat(t.data.data),e.id=t.data.data.id)},fail:function(){},complete:function(){}})},getmoments:function(){var e=this;t.request({url:this.baseurl+"/api/moments/momentsInfo",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,city:t.getStorageSync("citySel")},success:function(t){console.log("圈子详情",t.data.data),e.list=t.data.data,e.list.photo&&(e.list.photo=e.list.photo.map((function(t){return JSON.parse(t)})));var o=e.list.video_xcx;o.length>0&&(o[0].width<o[0].height?(o[0].width_b=300,o[0].height_b=300/o[0].width*o[0].height):(o[0].width_b=600,o[0].height_b=600/o[0].width*o[0].height)),e.list.video_xcx=o,console.log("更新后的详情",e.list)},fail:function(){},complete:function(){}})},CommentDo:function(t,e,o,n){this.type=t,this.id=e,this.back_id=o,this.placeholder="回复 : ".concat(n)},fubs:function(){var e=this,o=t.getStorageSync("token");if(!o)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var n=t.getStorageSync("loginInfo");return n&&0==n.status?(t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1):this.pingjiaClick?(this.pingjiaClick=!1,setTimeout((function(t){e.pingjiaClick=!0}),1e3),""==this.commentValue?(t.showToast({title:"请输入评价内容",icon:"none"}),!1):void(0==this.type?t.request({url:this.baseurl+"/api/moments/momentsCommentDo",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,comment:this.commentValue,city:t.getStorageSync("citySel")},success:function(t){console.log("直接发表",t),e.commentValue="",e.placeholder=" ",e.shauxinComm()},fail:function(){},complete:function(){}}):1==this.type?t.request({url:this.baseurl+"/api/moments/momentsCommentDo",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,comment_id:this.id,back_id:this.back_id,comment:this.commentValue,city:t.getStorageSync("citySel")},success:function(t){console.log("回复一级",t),e.commentValue="",e.placeholder=" ",e.type=0,e.shauxinComm()},fail:function(){},complete:function(){}}):2==this.type&&t.request({url:this.baseurl+"/api/moments/momentsCommentDo",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:this.moments_no,comment_id:this.id,back_id:this.back_id,comment:this.commentValue,city:t.getStorageSync("citySel")},success:function(t){console.log("回复二级",t),e.type=0,e.commentValue="",e.placeholder=" ",e.shauxinComm()},fail:function(){},complete:function(){}}))):(t.showToast({title:"请勿连续点击",icon:"none"}),!1)},MomentLike:function(e){var o=this,n=t.getStorageSync("token");if(!n)return t.showToast({title:"请先登录",icon:"none"}),void setTimeout((function(e){t.reLaunch({url:"/pages/Login/Login"})}),1e3);var i=t.getStorageSync("loginInfo");if(i&&0==i.status)return t.showToast({title:"请先完善信息",icon:"none"}),setTimeout((function(e){t.navigateTo({url:"/pages_yindao/yindao1/yindao1"})}),1e3),!1;t.request({url:this.baseurl+"/api/moments/momentsLike",method:"POST",header:{xcx:1,token:this.token},data:{moments_no:e,city:t.getStorageSync("citySel")},success:function(e){console.log("喜欢",e.data.data),0==e.data.data?(o.list.is_like=e.data.data,o.list.like_num-=1,t.request({url:o.baseurl+"/api/moments/momentsInfo",method:"POST",header:{xcx:1,token:o.token},data:{moments_no:o.moments_no,city:t.getStorageSync("citySel")},success:function(t){console.log("圈子详情",t.data.data),o.list.likePeople=t.data.data.likePeople},fail:function(){},complete:function(){}})):1==e.data.data&&(o.list.is_like=e.data.data,o.list.like_num+=1,t.request({url:o.baseurl+"/api/moments/momentsInfo",method:"POST",header:{xcx:1,token:o.token},data:{moments_no:o.moments_no,city:t.getStorageSync("citySel")},success:function(t){console.log("圈子详情",t.data.data),o.list.likePeople=t.data.data.likePeople},fail:function(){},complete:function(){}}))},fail:function(){},complete:function(){}})},previewImage:function(e,o){console.log(e,o);var n=[];e.forEach((function(t){return n.push(t.imgUrl)})),console.log(n),t.previewImage({current:o,urls:n,success:function(t){console.log(t)}})}}};e.default=o}).call(this,o("543d")["default"])},"1b05":function(t,e,o){"use strict";var n=o("d921"),i=o.n(n);i.a},"3a7c":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var n={videos:function(){return o.e("components/videos/videos").then(o.bind(null,"af9a"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.list.photo&&t.list.photo.length>0),n=o?t.list.photo.length:null,i=o?t.__map(t.list.photo,(function(e,o){var n=t.__get_orig(e),i=t.list.photo.length>1&&t.list.photo.length<4;return{$orig:n,g2:i}})):null,a=o?t.__map(t.list.photo,(function(e,o){var n=t.__get_orig(e),i=1==t.list.photo.length&&e.width>e.height&&e.width>250;return{$orig:n,g3:i}})):null,s=o?t.__map(t.list.photo,(function(e,o){var n=t.__get_orig(e),i=1==t.list.photo.length&&e.width<e.height&&e.height>300;return{$orig:n,g4:i}})):null,c=o?t.__map(t.list.photo,(function(e,o){var n=t.__get_orig(e),i=1==t.list.photo.length&&e.width==e.height;return{$orig:n,g5:i}})):null,l=t.__map(t.CommentList,(function(e,o){var n=t.__get_orig(e),i=t.__map(e.son,(function(e,o){var n=t.__get_orig(e),i=e.back.length;return{$orig:n,g6:i}}));return{$orig:n,l4:i}})),u=t.CommentList.length,m=t.placeholder.length;t.$mp.data=Object.assign({},{$root:{g0:o,g1:n,l0:i,l1:a,l2:s,l3:c,l5:l,g7:u,g8:m}})},a=[]},"820c":function(t,e,o){"use strict";o.r(e);var n=o("3a7c"),i=o("ac26");for(var a in i)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("1b05");var s=o("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"13091a29",null,!1,n["a"],void 0);e["default"]=c.exports},ac26:function(t,e,o){"use strict";o.r(e);var n=o("0b23"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},d921:function(t,e,o){},da58:function(t,e,o){"use strict";(function(t,e){var n=o("4ea4");o("a1a6");n(o("66fd"));var i=n(o("820c"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])}},[["da58","common/runtime","common/vendor"]]]);